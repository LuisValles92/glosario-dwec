<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>formularios_16 - Ejercicio: Editar una selección de opciones</title>
</head>

<body>
    <h1>formularios_16 - Ejercicio: Editar una selección de opciones</h1>

    <input type="text" id="codigociudad" placeholder="CÓDIGO DE CIUDAD" /><br /><br />
    <input type="text" id="ciudad" placeholder="CIUDAD" /><br /><br /><br />

    <input type="radio" id="insertar" name="operacion" value="ins" checked="checked">Insertar
    <br /><br />
    <input type="radio" id="eliminar" name="operacion" value="eli">Eliminar seleccionado
    <br /><br />
    <input type="radio" id="modificar" name="operacion" value="mod">Modificar seleccionado
    <br /><br />

    <hr>
    <input type="checkbox" id="multiple" name="multiple" onchange="seleccionarMultiple();" />Selección múltiple
    <hr><br /><br />

    <hr>
    <button onclick="procesar()">Procesar</button>
    <hr><br /><br />

    <select id="select_ciudades"></select>


    <script type="text/javascript">
        function seleccionarMultiple() {
            var ciudades = document.getElementById("select_ciudades");

            if (document.getElementById("multiple").checked) {
                if (!ciudades.hasAttribute("multiple")) {
                    ciudades.setAttribute("multiple", "multiple");
                    ciudades.setAttribute("size", "10");
                }
            } else {
                if (ciudades.hasAttribute("multiple") && ciudades.hasAttribute("size")) {
                    ciudades.removeAttribute("multiple");
                    ciudades.removeAttribute("size");
                }
            }
        }


        function procesar() {

            if (document.getElementById("codigociudad").value != "" && document.getElementById("ciudad").value != "") {

                if (document.getElementById("insertar").checked) {
                    var opcion = document.createElement("option");
                    opcion.setAttribute("value", document.getElementById("codigociudad").value);
                    opcion.textContent = document.getElementById("ciudad").value;
                    document.getElementById("select_ciudades").appendChild(opcion);
                }

                if (document.getElementById("eliminar").checked) {
                    var indice = document.getElementById("select_ciudades").selectedIndex;
                    document.getElementById("select_ciudades").options.remove(indice);
                }

                if (document.getElementById("modificar").checked) {
                    var indice = document.getElementById("select_ciudades").selectedIndex;
                    var opcionMod = document.getElementById("select_ciudades").options[indice];

                    opcionMod.value = document.getElementById("codigociudad").value;
                    opcionMod.textContent = document.getElementById("ciudad").value;
                }
            } else {
                alert("Rellena ambos campos");
            }
        }
    </script>
</body>

</html>